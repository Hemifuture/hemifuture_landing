---
/**
 * BlogPost.astro
 *
 * Layout for individual blog post pages
 * Uses Hemifuture design system for consistent styling.
 */

import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import BaseLayout from './BaseLayout.astro';
import ParticleCanvas from '../components/ParticleCanvas.astro';
import BackgroundEffects from '../components/BackgroundEffects.astro';
import Footer from '../components/Footer.astro';
import FormattedDate from '../components/FormattedDate.astro';

type Props = CollectionEntry<'blog'>['data'];

const { title, description, pubDate, updatedDate, heroImage } = Astro.props;
---

<BaseLayout title={`${title} â€” Hemifuture`} description={description}>
	<!-- Background Layers -->
	<ParticleCanvas />
	<BackgroundEffects />

	<!-- Main Content -->
	<main class="blog-post">
		<!-- Back Navigation -->
		<nav class="back-nav">
			<div class="container container-md">
				<a href="/blog" class="back-link">
					<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
						<path d="M12.5 15L7.5 10L12.5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
					</svg>
					<span>Back to Blog</span>
				</a>
				<a href="/" class="home-link">
					<span class="logo-text">Hemifuture</span>
				</a>
			</div>
		</nav>

		<!-- Article -->
		<article class="article">
			<!-- Hero Image -->
			{heroImage && (
				<div class="hero-image">
					<div class="container">
						<Image
							width={1200}
							height={600}
							src={heroImage}
							alt={title}
						/>
					</div>
				</div>
			)}

			<!-- Article Header -->
			<header class="article-header">
				<div class="container container-md">
					<div class="meta">
						<time class="date">
							<FormattedDate date={pubDate} />
						</time>
						{updatedDate && (
							<time class="updated-date">
								Updated: <FormattedDate date={updatedDate} />
							</time>
						)}
					</div>
					<h1 class="article-title">{title}</h1>
					{description && (
						<p class="article-description">{description}</p>
					)}
				</div>
			</header>

			<!-- Article Content -->
			<div class="article-content">
				<div class="container container-md">
					<div class="prose">
						<slot />
					</div>
				</div>
			</div>
		</article>

		<Footer />
	</main>
</BaseLayout>

<style>
	.blog-post {
		position: relative;
		z-index: var(--z-base);
		min-height: 100vh;
	}

	/* Back Navigation */
	.back-nav {
		padding: var(--space-8) 0;
		opacity: 0;
		animation: fadeInUp var(--duration-slow) var(--ease-spring) var(--delay-300) forwards;
	}

	.back-nav .container {
		display: flex;
		justify-content: space-between;
		align-items: center;
	}

	.back-link,
	.home-link {
		display: inline-flex;
		align-items: center;
		gap: var(--space-2);
		font-size: var(--text-sm);
		font-weight: var(--font-weight-medium);
		color: var(--color-text-secondary);
		text-decoration: none;
		transition: var(--transition-normal);
	}

	.back-link:hover,
	.home-link:hover {
		color: var(--color-aurora-400);
	}

	.back-link svg {
		transition: var(--transition-normal);
	}

	.back-link:hover svg {
		transform: translateX(-4px);
	}

	.logo-text {
		font-family: var(--font-display);
		font-size: var(--text-base);
		letter-spacing: var(--text-style-logo-tracking);
		background: var(--gradient-text);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-clip: text;
	}

	/* Hero Image */
	.hero-image {
		margin-bottom: var(--space-12);
		opacity: 0;
		animation: fadeInUp var(--duration-slow) var(--ease-spring) var(--delay-600) forwards;
	}

	.hero-image img {
		width: 100%;
		height: auto;
		border-radius: var(--radius-xl);
		border: 1px solid var(--color-border-subtle);
		box-shadow: var(--shadow-lg);
	}

	/* Article Header */
	.article-header {
		padding-bottom: var(--space-12);
		text-align: center;
		opacity: 0;
		animation: fadeInUp var(--duration-slow) var(--ease-spring) var(--delay-900) forwards;
	}

	.meta {
		display: flex;
		justify-content: center;
		align-items: center;
		gap: var(--space-4);
		margin-bottom: var(--space-6);
		font-size: var(--text-xs);
		font-family: var(--font-body);
		letter-spacing: var(--text-style-label-tracking);
		text-transform: uppercase;
		color: var(--color-text-tertiary);
	}

	.updated-date {
		font-style: italic;
		opacity: 0.8;
	}

	.article-title {
		font-family: var(--font-display);
		font-size: var(--text-display-md);
		font-weight: var(--font-weight-light);
		line-height: var(--line-height-tight);
		color: var(--color-text-primary);
		margin: 0 0 var(--space-6) 0;
	}

	.article-description {
		font-size: var(--text-lg);
		line-height: var(--line-height-relaxed);
		color: var(--color-text-secondary);
		margin: 0;
		max-width: var(--container-sm);
		margin-left: auto;
		margin-right: auto;
	}

	/* Article Content / Prose */
	.article-content {
		padding-bottom: var(--space-24);
		opacity: 0;
		animation: fadeInUp var(--duration-slow) var(--ease-spring) var(--delay-1200) forwards;
	}

	.prose {
		font-size: var(--text-base);
		line-height: var(--line-height-relaxed);
		color: var(--color-text-primary);
	}

	.prose :global(h2),
	.prose :global(h3),
	.prose :global(h4) {
		font-family: var(--font-display);
		font-weight: var(--font-weight-normal);
		line-height: var(--line-height-tight);
		color: var(--color-text-primary);
		margin-top: var(--space-12);
		margin-bottom: var(--space-4);
	}

	.prose :global(h2) {
		font-size: var(--text-2xl);
		border-bottom: 1px solid var(--color-border-subtle);
		padding-bottom: var(--space-3);
	}

	.prose :global(h3) {
		font-size: var(--text-xl);
	}

	.prose :global(h4) {
		font-size: var(--text-lg);
	}

	.prose :global(p) {
		margin-bottom: var(--space-6);
	}

	.prose :global(a) {
		color: var(--color-aurora-400);
		text-decoration: none;
		border-bottom: 1px solid transparent;
		transition: var(--transition-normal);
	}

	.prose :global(a:hover) {
		border-bottom-color: var(--color-aurora-400);
	}

	.prose :global(strong) {
		font-weight: var(--font-weight-semibold);
		color: var(--color-text-primary);
	}

	.prose :global(em) {
		font-style: italic;
	}

	.prose :global(blockquote) {
		margin: var(--space-8) 0;
		padding-left: var(--space-6);
		border-left: 3px solid var(--color-aurora-400);
		color: var(--color-text-secondary);
		font-style: italic;
	}

	.prose :global(code) {
		font-family: 'Fira Code', 'Courier New', monospace;
		font-size: 0.9em;
		padding: 0.2em 0.4em;
		background: var(--color-surface-elevated);
		border: 1px solid var(--color-border-subtle);
		border-radius: var(--radius-sm);
	}

	.prose :global(pre) {
		margin: var(--space-6) 0;
		padding: var(--space-6);
		background: var(--color-surface-elevated);
		border: 1px solid var(--color-border-subtle);
		border-radius: var(--radius-lg);
		overflow-x: auto;
	}

	.prose :global(pre code) {
		padding: 0;
		background: none;
		border: none;
	}

	.prose :global(ul),
	.prose :global(ol) {
		margin: var(--space-6) 0;
		padding-left: var(--space-8);
	}

	.prose :global(li) {
		margin-bottom: var(--space-3);
	}

	.prose :global(img) {
		width: 100%;
		height: auto;
		border-radius: var(--radius-lg);
		border: 1px solid var(--color-border-subtle);
		margin: var(--space-8) 0;
	}

	.prose :global(hr) {
		border: none;
		border-top: 1px solid var(--color-border-subtle);
		margin: var(--space-12) 0;
	}

	/* Responsive */
	@media (max-width: 768px) {
		.back-nav {
			padding: var(--space-6) 0;
		}

		.article-title {
			font-size: var(--text-display-sm);
		}

		.article-description {
			font-size: var(--text-base);
		}

		.prose {
			font-size: var(--text-sm);
		}

		.prose :global(h2) {
			font-size: var(--text-xl);
		}

		.prose :global(h3) {
			font-size: var(--text-lg);
		}
	}
</style>
